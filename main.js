var json = {
    "artworks": [
        {
            "filename": "st-francis-in-ecstasy-1485.jpg",
            "wikiartLink": "https://uploads5.wikiart.org/images/giovanni-bellini/st-francis-in-ecstasy-1485.jpg!Large.jpg",
            "artist": "Giovanni Bellini",
            "year": 1485,
            "styles": "Early Renaissance",
            "genre": "Religious Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "school-of-athens-detail-from-right-hand-side-showing-diogenes-on-the-steps-and-euclid-1511.jpg",
            "wikiartLink": "https://uploads6.wikiart.org/images/raphael/school-of-athens-detail-from-right-hand-side-showing-diogenes-on-the-steps-and-euclid-1511.jpg!Large.jpg",
            "artist": "Raphael",
            "year": 1511,
            "styles": "High Renaissance",
            "genre": "History Painting",
            "resultGrouping": "Modular"
        },
        {
            "filename": "hare-1528.jpg",
            "wikiartLink": "https://uploads7.wikiart.org/images/albrecht-durer/hare-1528(1).jpg!Large.jpg",
            "artist": "Albrecht Durer",
            "year": 1528,
            "styles": "Northern Renaissance",
            "genre": "Animal Painting",
            "resultGrouping": "Ais"
        },
        {
            "filename": "the-lamentation-rubens.jpg",
            "wikiartLink": "https://uploads6.wikiart.org/images/peter-paul-rubens/the-lamentation-1.jpg!Large.jpg",
            "artist": "Peter Paul Rubens",
            "year": 1609,
            "styles": "Flemish Baroque",
            "genre": "Religious Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "youth-reading-1626.jpg",
            "wikiartLink": "https://uploads1.wikiart.org/images/reza-abbasi/youth-reading-1626.jpg!Large.jpg",
            "artist": "Rezā ʿAbbāsī",
            "year": 1626,
            "styles": "Safavid Period",
            "genre": "Miniature",
            "resultGrouping": "Human"
        },
        {
            "filename": "slaughtered-ox",
            "wikiartLink": "https://uploads6.wikiart.org/images/rembrandt/the-carcass-of-an-ox-1657.jpg!Large.jpg",
            "artist": "Rembrandt",
            "year": 1655,
            "styles": "Dutch Baroque",
            "genre": "Still Life",
            "resultGrouping": "Ais"
        },
        {
            "filename": "the-monk-by-the-sea-friedrich",
            "wikiartLink": "https://uploads5.wikiart.org/00126/images/caspar-david-friedrich/the-monk-by-the-sea-0a.jpg!Large.jpg",
            "artist": "Caspar David Friedrich",
            "year": 1810,
            "styles": "Romanticism",
            "genre": "Landscape",
            "resultGrouping": "Ais"
        },
        {
            "filename": "the-third-of-may-francisco-goya.jpg",
            "wikiartLink": "https://uploads4.wikiart.org/images/francisco-goya/execution-of-the-defenders-of-madrid-3rd-may-1808-1814.jpg!Large.jpg",
            "artist": "Francisco Goya ",
            "year": 1814,
            "styles": "Romanticism",
            "genre": "History Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "the-raft-of-the-medusa-gericault",
            "wikiartLink": "https://uploads2.wikiart.org/images/theodore-gericault/the-raft-of-the-medusa-1819(1).jpg!Large.jpg",
            "artist": "Théodore Géricault",
            "year": 1819,
            "styles": "Romanticism",
            "genre": "History Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "fine-wind-clear-morning-hokusai.jpg",
            "wikiartLink": "https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/Red_Fuji_southern_wind_clear_morning.jpg/1600px-Red_Fuji_southern_wind_clear_morning.jpg",
            "artist": "Hokusai",
            "year": 1830,
            "styles": "Ukiyo-E",
            "genre": "Landscape",
            "resultGrouping": "Ais"
        },
        {
            "filename": "the-great-wave-off-kanagawa-hokusai.jpg",
            "wikiartLink": "https://uploads6.wikiart.org/00129/images/katsushika-hokusai/the-great-wave-off-kanagawa.jpg!Large.jpg",
            "artist": "Hokusai",
            "year": 1831,
            "styles": "Ukiyo-E",
            "genre": "Landscape",
            "resultGrouping": "Human"
        },
        {
            "filename": "bridal-veil-falls-yosemite-bierstadt.jpg",
            "wikiartLink": "https://uploads5.wikiart.org/images/albert-bierstadt/bridal-veil-falls-yosemite.jpg!Large.jpg",
            "artist": "Albert Bierstadt",
            "year": 1871,
            "styles": "Hudson River School",
            "genre": "Landscape",
            "resultGrouping": "Ais"
        },
        {
            "filename": "impression-sunrise.jpg",
            "wikiartLink": "https://uploads0.wikiart.org/00129/images/claude-monet/impression-sunrise.jpg!Large.jpg",
            "artist": "Claude Monet",
            "year": 1872,
            "styles": "Impressionism",
            "genre": "Cityscape",
            "resultGrouping": "Modular"
        },
        {
            "filename": "songoku-the-monkey-king-and-the-jewelled-hare-by-the-moon-yoshitoshi.jpg",
            "wikiartLink": "https://uploads8.wikiart.org/images/tsukioka-yoshitoshi/songoku-the-monkey-king-and-the-jewelled-hare-by-the-moon-1891.jpg!Large.jpg",
            "artist": "Yoshitoshi",
            "year": 1891,
            "styles": "Ukiyo-E",
            "genre": "Portrait",
            "resultGrouping": "Ais"
        },
        {
            "filename": "lake-traunsee-with-the-schlafende-griechin-mountain.jpg",
            "wikiartLink": "https://uploads3.wikiart.org/images/richard-gerstl/lake-traunsee-with-the-schlafende-griechin-mountain(1).jpg",
            "artist": "Richard Gerstl",
            "year": 1907,
            "styles": "Expressionism",
            "genre": "Landscape",
            "resultGrouping": "Modular"
        },
        {
            "filename": "the-posts-1910.jpg",
            "wikiartLink": "https://uploads1.wikiart.org/images/leon-spilliaert/the-posts-1910.jpg!Large.jpg",
            "artist": "Leon Spilliaert",
            "year": 1910,
            "styles": "Expressionism, Symbolism",
            "genre": "Symbolic Painting",
            "resultGrouping": "Ais"
        },
        {
            "filename": "white-on-white-malevich.png",
            "wikiartLink": "https://uploads6.wikiart.org/00132/images/kazimir-malevich/white-on-white-malevich-1918.png!Large.png",
            "artist": "Kazimir Malevich",
            "year": 1918,
            "styles": "Suprematism",
            "genre": "Abstract",
            "resultGrouping": "Modular"
        },
        {
            "filename": "space-force-construction-lyubov-popova.jpg",
            "wikiartLink": "https://uploads2.wikiart.org/images/lyubov-popova/space-force-construction-3.jpg!Large.jpg",
            "artist": "Lyubov Popova",
            "year": 1921,
            "styles": "Suprematism",
            "genre": "Abstract",
            "resultGrouping": "Modular"
        },
        {
            "filename": "frozen-assets-diego-rivera.jpg",
            "wikiartLink": "https://uploads5.wikiart.org/images/diego-rivera/frozen-assets-1931(1).jpg!Large.jpg",
            "artist": "Diego Rivera",
            "year": 1931,
            "styles": "Muralism",
            "genre": "Genre Painting",
            "resultGrouping": "Modular"
        },
        {
            "filename": "cormorant-1931.jpg",
            "wikiartLink": "https://uploads4.wikiart.org/images/xu-beihong/cormorant-1931.jpg",
            "artist": "Xu Beihong",
            "year": 1931,
            "styles": "Expressionism, Ink and Wash Painting",
            "genre": "Animal Painting",
            "resultGrouping": "Ais"
        },
        {
            "filename": "the-two-fridas-1939.jpg",
            "wikiartLink": "https://uploads5.wikiart.org/images/magdalena-carmen-frieda-kahlo-y-calder%C3%B3n-de-rivera/the-two-fridas-1939.jpg!Large.jpg",
            "artist": "Frida Kahlo",
            "year": 1939,
            "styles": "Naive Art (Primitivism), Surrealism",
            "genre": "Self Portrait",
            "resultGrouping": "Modular"
        },
        {
            "filename": "darjeeling-and-fog-1945.jpg",
            "wikiartLink": "https://uploads7.wikiart.org/images/nandalal-bose/darjeeling-and-fog-1945.jpg",
            "artist": "Nandalal Bose",
            "year": 1945,
            "styles": "Contextual Modernism",
            "genre": "Landscape",
            "resultGrouping": "Ais"
        },
        {
            "filename": "absolut-britto-romero-britto.jpg",
            "wikiartLink": "https://uploads7.wikiart.org/images/romero-britto/absolut-britto.jpg",
            "artist": "Romero Britto",
            "year": 1988,
            "styles": "Neo-Pop Art",
            "genre": "Advertisement",
            "resultGrouping": "Modular"
        },
        {
            "filename": "school-of-gladiators-1953.jpg",
            "wikiartLink": "https://uploads6.wikiart.org/images/giorgio-de-chirico/school-of-gladiators-1953.jpg!Large.jpg",
            "artist": "Giorgio de Chirico",
            "year": 1953,
            "styles": "Neo-Baroque",
            "genre": "Genre Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "mycenae-kline.jpg",
            "wikiartLink": "https://uploads4.wikiart.org/images/franz-kline/mycenae-1958.jpg!Large.jpg",
            "artist": "Franz Kline",
            "year": 1958,
            "styles": "Abstract Expressionism",
            "genre": "Abstract",
            "resultGrouping": "Modular"
        },
        {
            "filename": "buffalo-ii-rauschenberg.jpg",
            "wikiartLink": "https://uploads7.wikiart.org/images/robert-rauschenberg/kennedy.jpg!Large.jpg",
            "artist": "Robert Rauschenberg",
            "year": 1964,
            "styles": "Neo-Dada",
            "genre": "Figurative",
            "resultGrouping": "Human"
        },
        {
            "filename": "landscape-1969.jpg",
            "wikiartLink": "https://uploads6.wikiart.org/images/ding-yanyong/landscape-1969.jpg",
            "artist": "Ding Yanyong",
            "year": 1969,
            "styles": "Expressionism",
            "genre": "Marina",
            "resultGrouping": "Modular"
        },
        {
            "filename": "hallucinogenic-toreador-1970.jpg",
            "wikiartLink": "https://uploads4.wikiart.org/images/salvador-dali/hallucinogenic-toreador-1970.jpg!Large.jpg",
            "artist": "Salvador Dali",
            "year": 1970,
            "styles": "Neoclassicism, Surrealism",
            "genre": "Symbolic Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "sleeping-cat-1978.jpg",
            "wikiartLink": "https://uploads0.wikiart.org/images/ding-yanyong/sleeping-cat-1978.jpg",
            "artist": "Ding Yanyong",
            "year": 1978,
            "styles": "Expressionism, Ink and Wash Painting",
            "genre": "Animal Painting",
            "resultGrouping": "Ais"
        },
        {
            "filename": "untitled-1978.jpg",
            "wikiartLink": "https://uploads2.wikiart.org/images/zdislav-beksinski/untitled-1978.jpg!Large.jpg",
            "artist": "Zdzisław Beksiński",
            "year": 1978,
            "styles": "Surrealism",
            "genre": "Symbolic Painting",
            "resultGrouping": "Ais"
        },
        {
            "filename": "skull-basquiat.jpg",
            "wikiartLink": "https://uploads5.wikiart.org/images/jean-michel-basquiat/head.jpg!Large.jpg",
            "artist": "Jean-Michel Basquiat",
            "year": 1981,
            "styles": "Neo-Expressionism, Expressionism",
            "genre": "Figurative",
            "resultGrouping": "Modular"
        },
        {
            "filename": "untitled-woman-playing-sitar-mf-husain.jpg",
            "wikiartLink": "https://uploads8.wikiart.org/images/m-f-husain/untitled-woman-playing-sitar-1986(1).jpg",
            "artist": "M.F. Husain",
            "year": 1986,
            "styles": "Cubism, Expressionism",
            "genre": "Genre Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "qaf-mfhusain.jpg",
            "wikiartLink": "https://uploads4.wikiart.org/00164/images/m-f-husain/qaf.jpg",
            "artist": "M.F. Husain",
            "year": 1978,
            "styles": "Cubo-Expressionism",
            "genre": "Religious Painting",
            "resultGrouping": "Modular"
        },
        {
            "filename": "massacre-in-korea-pablo-picasso.jpg",
            "wikiartLink": "https://uploads1.wikiart.org/00234/images/pablo-picasso/massacre-in-korea.jpg!Large.jpg",
            "artist": "Pablo Picasso",
            "year": 1951,
            "styles": "Expressionism",
            "genre": "History Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "tughriyat-ebni-zuhair-1993.jpg",
            "wikiartLink": "https://uploads2.wikiart.org/images/ali-omar-ermes/tughriyat-ebni-zuhair-1993.jpg",
            "artist": "Ali Omar Ermes",
            "year": 1993,
            "styles": "Lyrical Abstraction",
            "genre": "Abstract, Caligraphy",
            "resultGrouping": "Modular"
        },
        {
            "filename": "Execution-Yue-MinJun.jpg",
            "wikiartLink": "https://upload.wikimedia.org/wikipedia/en/5/5f/Chineseart_Executionpainting.jpg",
            "artist": "Yue MinJun",
            "year": 1995,
            "styles": "Cynical Realism",
            "genre": "Symbolic Painting",
            "resultGrouping": "Human"
        },
        {
            "filename": "untitled-052-1998.jpg",
            "wikiartLink": "https://uploads8.wikiart.org/images/rafa-nasiri/untitled-052-1998.jpg",
            "artist": "Rafa Nasiri",
            "year": 1998,
            "styles": "Abstract Expressionism",
            "genre": "Abstract",
            "resultGrouping": "Modular"
        },
        {
            "filename": "fast-food-nyoman-masriadi.jpg",
            "wikiartLink": "https://uploads0.wikiart.org/images/nyoman-masriadi/fast-food-1999.jpg",
            "artist": "Nyoman Masriadi",
            "year": 1999,
            "styles": "Neo-Expressionism",
            "genre": "Portrait",
            "resultGrouping": "Human"
        },
        {
            "filename": "chaos-takashi-murakami.jpg",
            "wikiartLink": "https://uploads6.wikiart.org/images/takashi-murakami/chaos-1999.jpg",
            "artist": "Takashi Murakami",
            "year": 1999,
            "styles": "Neo-Pop Art, Superflat",
            "genre": "Figurative",
            "resultGrouping": "Ais"
        },
        {
            "filename": "greenacross-i-2009.jpg",
            "wikiartLink": "https://uploads2.wikiart.org/images/frank-bowling/greenacross-i-2009.jpg",
            "artist": "Frank Bowling",
            "year": 2009,
            "styles": "Lyrical Abstraction",
            "genre": "Abstract",
            "resultGrouping": "Ais"
        }
    ],
    "users": [
        {
            "userid": "hello@alexandria.app",
            "timestamp": "2020-08-26T22:10:31Z",
            "liked": [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            "modular": 10,
            "human": 10,
            "ais": 10
        }
    ]
};
// image array controls
var imageArray = json.artworks;
var counter = 0;
var currentPainting = imageArray[counter];

// Collected user data
// TODO userid, timestamp
var likeArray = new Array(40);
var modular = 0;
var human = 0;
var ais = 0;
var timestamp;
var userid; 

// Misc variables
var current = -1;
var pick = true;
var style = window.getComputedStyle(document.getElementById("progress"));
var width = style.getPropertyValue('width');
var step = parseInt(width, 10) / 40;
var style2 = window.getComputedStyle(document.getElementById("one"));
var docheight = style2.getPropertyValue('height');
var barlength = 0;

// Initial centering on page load
window.onload = function() {
	document.getElementById("pic3").style.transition = "none";
	var top = (window.innerHeight - document.getElementById("pic3").offsetHeight) / 2;
	document.getElementById("pic3").style.marginTop = top + "px";
	document.getElementById("pic1").style.transition = "none";
	top = (window.innerHeight - document.getElementById("pic1").offsetHeight) / 2;
	document.getElementById("pic1").style.marginTop = top + "px";
	document.getElementById("pic3").style.transition = "1s";
	document.getElementById("pic1").style.transition = "1s";
};

// Centers all images every half second
setInterval(function() {
	var top = (window.innerHeight - document.getElementById("pic1").offsetHeight) / 2;
	document.getElementById("pic1").style.marginTop = top + "px";
	var top = (window.innerHeight - document.getElementById("pic2").offsetHeight) / 2;
	document.getElementById("pic2").style.marginTop = top + "px";
}, 500);

///////////////////////////////
// Listeners for button push //
///////////////////////////////

// Onclick function for quiz start
document.getElementById("start").addEventListener("click", function(){
	document.getElementById("text").style.opacity = 0;
	document.getElementById("pic3").style.opacity = 0;
	document.getElementById("start").style.opacity = 0;
	document.getElementById("pic1").style.opacity = 0;
	document.getElementById("choices").style.opacity = 0;
	document.getElementById("progress").style.opacity = 0;
	document.getElementById("progtext").style.opacity = 0;
	setTimeout(initiate, 1200);
	setTimeout(function() {
		document.getElementById("pic1").style.opacity = 1;
		document.getElementById("choices").style.opacity = 1;
		document.getElementById("progress").style.opacity = 1;
		document.getElementById("progtext").style.opacity = 1;
	}, 1500);
});

// Helper to hide initial quiz state
function initiate() {
	document.getElementById("text").classList.add("hide");
	document.getElementById("pic3").classList.add("hide");
	document.getElementById("start").classList.add("hide");
	document.getElementById("pic1").classList.remove("hide");
	document.getElementById("choices").classList.remove("hide");
	document.getElementById("progress").classList.remove("hide");
	document.getElementById("progtext").classList.remove("hide");
};

// Onclick for check mark
document.getElementById("yesbutton").addEventListener("click", function(){
	disable();
	document.getElementById('no').style.transition = "none";
	document.getElementById('no').style.stroke = "#4A0C0E";
	// likeArray[counter]++;
	like();
    magic();
});

// Onclick for X mark
document.getElementById("nobutton").addEventListener("click", function(){
	disable();
	document.getElementById('yes').style.transition = "none";
	document.getElementById('yes').style.stroke = "#4A0C0E";
	magic();
});

// Helper that disables buttons
function disable() {
	document.getElementById("yesbutton").disabled = true;
	document.getElementById("nobutton").disabled = true;
	document.getElementById("yes").classList.remove("hover");
	document.getElementById("no").classList.remove("hover");
	document.getElementById("yesbutton").style.cursor = "auto";
	document.getElementById("nobutton").style.cursor = "auto";
}

// Helper that enables buttons
function enable() {
	document.getElementById("yesbutton").disabled = false;
	document.getElementById("nobutton").disabled = false;
	document.getElementById("yes").classList.add("hover");
	document.getElementById("no").classList.add("hover");
	document.getElementById("yesbutton").style.cursor = "pointer";
	document.getElementById("nobutton").style.cursor = "pointer";
	document.getElementById('yes').style.transition = "0.25s";
	document.getElementById('no').style.transition = "0.25s";
	document.getElementById('yes').style.stroke = "white";
	document.getElementById('no').style.stroke = "white";
}

// Helper function that fades and switches out pictures
function magic() {
	var currentPaintingLink = imageArray[counter+1].wikiartLink;
    console.log(currentPaintingLink);
    if(pick){
        var cur = "pic1";
        var nex = "pic2";
    }
    else{
        var cur = "pic2";
        var nex = "pic1";
    }
    counter++;
    document.getElementById(cur).style.transition = "1s";
    document.getElementById(cur).style.opacity = 0;
    // document.getElementById("palette").style.opacity = 0;
    document.getElementById(nex).src = currentPaintingLink;
    setTimeout(baradvance, 500);
	setTimeout(advance, 1200, cur, nex);
    setTimeout(function() {
        document.getElementById(nex).style.transition = "1s";
        document.getElementById(nex).style.opacity = 1;
		// document.getElementById("palette").style.opacity = 1;
	}, 1500);
	setTimeout(enable, 1500);
    pick = !pick;
}

// Helper for the helper that switches out pictures
function advance(cur, nex) {
	document.getElementById(cur).classList.add("hide");
	// document.getElementById("palette").src = palettes[current+1];
	document.getElementById(nex).classList.remove("hide");
}

// Helper that advances progress bar
function baradvance() {
	barlength += 2.5;
	if (barlength >= 100) {
		document.getElementById("progressbar").style.width = "100%";
	}
	else {
		document.getElementById("progressbar").style.width = barlength + "%";
	}
	document.getElementById("progtext").innerHTML = (counter+1) + " of 40";
}

///////////////////////////
// Server side functions //
///////////////////////////

function like() {
    likeArray[counter]++;
    var resultGrouping = currentPainting.resultGrouping;
    console.log(resultGrouping);
    if(resultGrouping.match("Human"))
        human++;
    else if (resultGrouping.match("Modular"))
        modular++;
    else if (resultGrouping.match("Ais"))
        ais++;
}


// Converts user data to JSON, then sends to firebase.
function sendUserInfo() {

}

// compare results sums, and switches to results page 
// not sure how to do edge cases yet 
function createResults() {
    if(modular >= human && modular >= ais) {
        // switch to modular results
    }
    else if(human >= modular && human >= ais) {
        // switch to human results
    }
    else if(ais >= modular && ais >= human) {
        // switch to ais results
    }
}

// chooses 3 of result art(need creation)
function chooseResultsImage(){

}